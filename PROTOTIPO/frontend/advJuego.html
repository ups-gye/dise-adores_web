
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¡SALTOS DE CIENCIAS!</title>
    <style>
        body {
            font-family: 'Comic Sans MS', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            text-align: center;
        }
        #gameContainer {
            background-image: url('img/fond.jpg');
            background-size: cover;
            width: 800px;
            height: 600px;
            margin: 20px auto;
            position: relative;
            border: 2px solid #000;
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.3);
        }
        #questionContainer, #boy, #cat, #stones, #lives, #progress, #moveButton {
            display: none; /* Ocultamos todo hasta que se inicie el juego */
        }
        #startButton {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            background-color: #28a745;
            color: #fff;
            font-size: 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
        }
        #startButton:hover {
            background-color: #218838;
        }
        .option {
            display: inline-block;
            background-color: #007bff;
            color: #fff;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .option:hover {
            background-color: #0056b3;
        }
        #lives {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
        }
        #progress {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 18px;
            color: #333;
        }
        #boy {
            position: absolute;
            bottom: 60px;
            left: 40px;
            width: 100px;
            transition: left 0.5s ease-in-out;
        }
        #cat {
            position: absolute;
            bottom: 80px;
            right: 100px;
            width: 100px;
            animation: bounce 2s infinite;
        }
        #stones {
            position: absolute;
            bottom: 50px; /* Ajustar la altura de las piedras para que estén más cerca del suelo */
            left: 160px; /* Ajustar la posición inicial de las piedras */
            width: 420px; /* Ajustar el ancho para que las piedras estén más juntas */
            height: 60px; /* Ajustar la altura */
            display: flex;
            justify-content: space-around; /* Espaciar las piedras uniformemente pero cercanas */
            align-items: center; /* Centrar verticalmente */
            z-index: 1;
        }

        .stone {
            width: 70px; /* Tamaño de las piedras */
            height: 70px; /* Tamaño de las piedras */
            background-image: url('img/piedra.webp');
            background-size: cover;
            border-radius: 50%;
        }

        #moveButton {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: none;
            font-size: 18px;
        }
        #moveButton:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }

        /* Estilos para la ventana modal */
        #retryModal {
            display: none; /* Oculto por defecto */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7); /* Fondo semi-transparente */
            justify-content: center;
            align-items: center;
        }

        #retryModalContent {
            background-color: #fff;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out; /* Animación de entrada */
        }

        #retryModalContent h2 {
            font-size: 24px;
            color: #333;
        }

        #retryButton {
            background-color: #dc3545;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 18px;
            transition: background-color 0.3s ease;
        }

        #retryButton:hover {
            background-color: #c82333;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .lives-animation {
            animation: blink 0.3s alternate infinite;
        }

        @keyframes blink {
            from { opacity: 1; }
            to { opacity: 0.5; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="lives">❤️❤️❤️</div>
        <div id="progress">Pregunta 1 de 5</div>
        <div id="questionContainer">
            <div id="question">Pregunta 1: ¿Cuál es la capital de Francia?</div>
            <div class="option" onclick="checkAnswer(0)">Madrid</div>
            <div class="option" onclick="checkAnswer(1)">París</div>
            <div class="option" onclick="checkAnswer(0)">Berlín</div>
        </div>
        <img id="boy" src="img/niño.png" alt="Niño">
        <img id="cat" src="img/gat.webp" alt="Gato">
        <div id="stones">
            <div class="stone"></div>
            <div class="stone"></div>
            <div class="stone"></div>
            <div class="stone"></div>
        </div>
        <button id="moveButton" onclick="move()">Mover</button>
        <button id="startButton" onclick="startGame()">Iniciar el Juego</button>
    </div>

    <div id="retryModal">
        <div id="retryModalContent">
            <h2>¡Has perdido todas tus vidas!</h2>
            <p>¿Quieres volver a intentarlo?</p>
            <button id="retryButton" onclick="resetGame()">Intentar de nuevo</button>
        </div>
    </div>

    <audio id="backgroundMusic" src="audio/angry-birds-videojuegos-.mp3" loop></audio>

    <script>
        let currentQuestion = 0;
        let lives = 3;
        let position = 0;

        const questions = [
            { question: "¿Cuál es la capital de Francia?", options: ["Madrid", "París", "Berlín"], correct: 1 },
            { question: "¿Cuál es la fórmula del agua?", options: ["CO2", "NaCl", "H2O"], correct: 2 },
            { question: "¿Cuántos planetas hay en el sistema solar?", options: ["8", "9", "10"], correct: 0 },
            { question: "¿Qué gas respiramos principalmente?", options: ["Oxígeno", "Hidrógeno", "Dióxido de carbono"], correct: 0 },
            { question: "¿Cuál es el metal más abundante en la corteza terrestre?", options: ["Hierro", "Aluminio", "Cobre"], correct: 1 }
        ];

        function startGame() {
            const audio = document.getElementById('backgroundMusic');
            audio.play().catch(error => {
                console.log("El navegador bloqueó la reproducción automática de audio.");
            });

            document.getElementById('startButton').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('boy').style.display = 'block';
            document.getElementById('cat').style.display = 'block';
            document.getElementById('stones').style.display = 'flex';
            document.getElementById('lives').style.display = 'block';
            document.getElementById('progress').style.display = 'block';

            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestion < questions.length) {
                const q = questions[currentQuestion];
                document.getElementById('question').innerText = q.question;
                const options = document.querySelectorAll('.option');
                for (let i = 0; i < options.length; i++) {
                    options[i].innerText = q.options[i];
                    options[i].onclick = () => checkAnswer(i);
                }
                document.getElementById('moveButton').style.display = 'none';
                document.getElementById('progress').innerText = `Pregunta ${currentQuestion + 1} de ${questions.length}`;
            }
        }

        function checkAnswer(selected) {
            if (selected === questions[currentQuestion].correct) {
                document.getElementById('moveButton').style.display = 'block';
            } else {
                lives--;
                updateLives();
                if (lives === 0) {
                    showRetryModal();
                } else {
                    alert("Respuesta incorrecta. Vuelve a intentarlo.");
                }
            }
        }

        function move() {
            const stones = document.querySelectorAll('.stone');

            if (position < stones.length) {
                const targetStone = stones[position];
                const currentLeft = parseInt(window.getComputedStyle(document.getElementById('boy')).left, 10);
                const targetLeft = targetStone.offsetLeft;

                animateMove(currentLeft, targetLeft, 500);

                setTimeout(() => {
                    position++;
                    document.getElementById('moveButton').style.display = 'none';
                    currentQuestion++;
                    if (currentQuestion < questions.length) {
                        loadQuestion();
                    } else {
                        moveToCat();
                    }
                }, 600);
            } else if (position === stones.length) {
                moveToCat();
            }
        }

        function moveToCat() {
            const boy = document.getElementById('boy');
            const cat = document.getElementById('cat');
            const catLeft = cat.offsetLeft - 100; // Mover al niño a la izquierda del gato

            animateMove(parseInt(window.getComputedStyle(boy).left, 10), catLeft, 800);

            setTimeout(() => {
                alert("¡Felicidades, cruzaste el río y te reencontraste con el gato!");
                showVictoryAnimation();
            }, 900);
        }

        function animateMove(startX, endX, duration) {
            const element = document.getElementById('boy');
            const frameRate = 60; // Número de fotogramas por segundo
            const totalFrames = Math.round((duration / 1000) * frameRate); // Número total de fotogramas para la duración especificada
            let currentFrame = 0;

            const distance = endX - startX;
            const step = distance / totalFrames;

            const interval = setInterval(() => {
                currentFrame++;
                const newLeft = startX + step * currentFrame;
                element.style.left = `${newLeft}px`;

                if (currentFrame >= totalFrames) {
                    clearInterval(interval); // Detener la animación cuando se complete
                    element.style.left = `${endX}px`; // Asegurarse de que el niño termine en la posición correcta
                }
            }, 1000 / frameRate); // Intervalo para cada fotograma basado en la tasa de fotogramas
        }

        function updateLives() {
            const livesContainer = document.getElementById('lives');
            livesContainer.innerHTML = '';
            for (let i = 0; i < lives; i++) {
                livesContainer.innerHTML += '❤️';
            }
            if (lives > 0 && lives < 3) {
                livesContainer.classList.add('lives-animation');
                setTimeout(() => livesContainer.classList.remove('lives-animation'), 1000);
            }
        }

        function showRetryModal() {
            document.getElementById('retryModal').style.display = 'flex';
        }

        function showVictoryAnimation() {
            const boy = document.getElementById('boy');
            boy.style.left = '660px';
            setTimeout(() => {
                alert("¡Felicidades! ¡Has ganado el juego!");
                resetGame();
            }, 1000);
        }

        function resetGame() {
            document.getElementById('retryModal').style.display = 'none';
            currentQuestion = 0;
            lives = 3;
            position = 0;
            document.getElementById('boy').style.left = '40px';
            document.getElementById('boy').style.bottom = '60px';
            updateLives();
            loadQuestion();
        }
    </script>
</body>
</html>
